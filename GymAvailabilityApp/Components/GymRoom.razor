@if (GymRooms != null)
{
    <Tabs RenderMode="TabsRenderMode.LazyReload" Background="Background.Light" SelectedTab="Home" Pills="true" TextColor="TextColor.Light" >
        <Items> 
            <Tab Name=Home >Home</Tab>

            @foreach (var gymRoom in GymRooms)
            {
                <Tab Name="@gymRoom.Name">@gymRoom.Name</Tab>
            }
        </Items>
        <Content>
            <TabPanel Name="Home">
                <Card>
                    <CardBody>
                        <CardTitle Size="3">
                            Welcome to the Gym Availability App
                        </CardTitle>
                        <CardText>
                            This app is designed to help you find the best time to go to the gym. It will show you which machines are available in each room of the gym.
                        </CardText>
                    </CardBody>
                </Card>
            </TabPanel>

            @foreach (var gymRoom in GymRooms)
            {
                <TabPanel Name="@gymRoom.Name">
                    <Card>


                        <CardBody>
                            <CardTitle Size="3">
                                @gymRoom.Name
                            </CardTitle>
                            <CardText>
                                <Table Narrow>
                                <TableHeader>
                                    <TableRow>
                                        <TableHeaderCell>Name </TableHeaderCell>
                                        <TableHeaderCell>Description</TableHeaderCell>
                                        <TableHeaderCell>Availability </TableHeaderCell>
                                        <TableHeaderCell> </TableHeaderCell>
                                    </TableRow>
                                </TableHeader>
                                <TableBody>
                                    @foreach (var machine in gymRoom.GymRoomMachines)
                                        {
                                            <TableRow>
                                                <TableRowCell>@machine.Name</TableRowCell>
                                                <TableRowCell>@machine.Description</TableRowCell>
                                                <TableRowCell>
                                                    @if ((machine.IsOccupied ??= false))
                                                    {
                                                        <Badge Color="Color.Danger">
                                                            <Tooltip Text="Unavaiable">
                                                                <Icon Name="IconName.Times" aria-label="Unavaiable" />

                                                            </Tooltip>
                                                        </Badge>
                                                    }
                                                    else
                                                    {
                                                        <Badge Color="Color.Success">
                                                            <Tooltip Text="Avaiable">
                                                                <Icon Name="IconName.Check" aria-label="Avaiable" />

                                                            </Tooltip>
                                                        </Badge>

                                                    }
                                                </TableRowCell>

                                                <TableRowCell>
                                                    <Button Color="Color.Primary" Clicked="@(e => ShowMachineDetailsModal(machine))">Details </Button>
                                                </TableRowCell>
                                            </TableRow>
                                        }
                                    </TableBody>
                                </Table>
                            </CardText>
                        </CardBody>
                        @if (gymRoom != null && gymRoom.RoomFileLink != null)
                        {
                            <CardImage Source="@gymRoom.RoomFileLink" Alt="Placeholder image" />


                        }
                    </Card>
                </TabPanel>
            }
        </Content>
    </Tabs>
}
else
{
    <Heading Size="HeadingSize.Is1">Error occured</Heading>
    <Heading Size="HeadingSize.Is4" Color="Color.Danger">Rooms have not been found</Heading>

}


@code {

    [Inject] public IModalService ModalService { get; set; }
    Task ShowMachineDetailsModal(MachineModel machineModel)
    {
        ModalService.Show<MachineDetailsModal>(parameters => parameters.Add(x => x.Machine, machineModel), new ModalInstanceOptions() { UseModalStructure = false });
        return Task.CompletedTask;
    }

    [Parameter]
    public List<GymRoomModel> GymRooms { get; set; }


}